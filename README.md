# API Call-Based Windows Malware Classifier #

This project implements a two-stage classifier to determine if a given program exhibits malicious behaviour based on the API calls that it makes. This workflow is detailed in the image below. Through the use of hyperparameter tuning and other optimisation techniques, the performance of the models are improved and saved for future deployment and use.

![Classifier Pipeline](Workflow.png)

## Dataset Sources ##

Dataset 1 consists of sequences of the first 100 non-repeated API calls made by an application. The labels for the dataset are binary; 0 represents a non-malicious program while 1 represents a malicious program. This dataset can be found at https://www.kaggle.com/ang3loliveira/malware-analysis-datasets-api-call-sequences.

Dataset 2 similarly consists of sequences of API calls made by an application when started. However, the labels comprise 8 different categories of malware based on the behaviour of these programs. This dataset can be found at https://www.kaggle.com/focatak/malapi2019.

## Python Packages Used ##
- NumPy
- Pandas
- TensorFlow
- Keras
- SciKit-Learn
- MatPlotLib
- Pickle

## Using the Machine Learning Models ##

Loading Keras Models:

    from keras.models import load_model
    model = load_model('final_model_dataset1.h5')
    Y_pred = model.predict(X_test)

Loading Pickled Model:

    import pickle
    with open('random_forest_model_dataset2', 'rb') as infile:
        model = pickle.load(infile)
    Y_pred = model.predict(X_test)
